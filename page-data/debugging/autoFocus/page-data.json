{"componentChunkName":"component---src-templates-post-template-tsx","path":"/debugging/autoFocus/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<blockquote>\n<p>사용자가 입력한 금액에 따라 자동으로 환전된 금액을 보여주도록 설계된 입력 필드에 React에서 <strong>autoFocus</strong>를 사용하여 자동으로 포커스를 되도록 했습니다.<br/>\r\n그러나 사용자가 다음 필드로 이동해 입력을 하려고 하면, focus out이 발생한 후 첫 글자만 입력된 뒤 autoFocus가 설정된 필드로 포커스가 이동하는 문제가 발생했습니다. <br/>\r\n이 문제를 어떻게 해결했는지 설명하겠습니다.</p>\n</blockquote>\n<h3>1. 문제 원인 분석</h3>\n<p>이 문제는 autoFocus 속성의 작동 방식과 React 컴포넌트의 상태 업데이트 후 리렌더링 과정에서 발생했습니다.\r\nReact에서 상태가 변경될 때마다 해당 상태를 사용하는 컴포넌트는 다시 렌더링됩니다. 따라서 <strong>autoFocus</strong>가 있는 입력 필드는 상태가 업데이트된 후 자동으로 포커스를 받게 됩니다.\r\n특히 여러 필드가 있는 상황에서는 사용자가 특정 필드에 입력을 시도할 때마다 원하지 않는 필드로 포커스가 이동하는 현상이 발생할 수 있습니다.</p>\n<h3>2. React의 autoFocus 동작 방식</h3>\n<ul>\n<li>\n<p><strong>autoFocus</strong>는 컴포넌트가 처음 마운트될 때 해당 입력 필드에 자동으로 포커스를 부여합니다.\r\n페이지가 로드되거나 컴포넌트가 처음 나타날 때 유용하지만, 동적인 상태 변화에서는 의도치 않은 방식으로 작동할 수 있습니다.</p>\n</li>\n<li>\n<p>한 번의 렌더링 사이클에서 여러 개의 <strong>autoFocus</strong>가 있을 경우, 마지막에 렌더링된 컴포넌트에 포커스가 갑니다.</p>\n</li>\n</ul>\n<h3>3. 해결 방안</h3>\n<blockquote>\n<h4>a. 자동 포커스 의존성 제거</h4>\n</blockquote>\n<p>autoFocus 속성 대신, 상태와 이벤트 핸들러를 통해 사용자가 선택한 필드에만 포커스가 유지되도록 변경했습니다.</p>\n<blockquote>\n<h4>b. 폼 상태 관리 개선</h4>\n</blockquote>\n<p>React Hook Form에서 제공하는 setValue 함수를 사용하여 필드 값을 업데이트하면서, 입력한 값이 상태와 폼 데이터 양쪽에서 일관되게 관리되도록 하면서 Focus out 문제를 해결했습니다.</p>\n<p>구체적으로 예시를 들어서 설명해보면,<br/><br/>\r\n<strong>이전</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span>TextField\r\n  autoFocus\r\n  value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span>\r\n  onChange<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>handleAmountChange<span class=\"token punctuation\">}</span>\r\n  placeholder<span class=\"token operator\">=</span><span class=\"token string\">\"You send\"</span>\r\n<span class=\"token operator\">/</span><span class=\"token operator\">></span></code></pre></div>\n<p>📌   이 코드는 필드에 자동으로 포커스를 맞췄지만, 다른 필드로 이동할 때 다시 자동으로 포커스가 돌아오는 문제가 있었습니다.</p>\n<p><strong>이후</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleAmountChange</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token function\">setCollectionAmountFocus</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 현재 필드에 포커스</span>\r\n  <span class=\"token function\">setPayoutAmountFocus</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 다른 필드 포커스 제거</span>\r\n  <span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">'collectionAmount'</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 상태 업데이트</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token punctuation\">;</span><span class=\"token operator\">&lt;</span>TextField\r\n  autoFocus<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token operator\">!</span>collectionAmountFocus <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>invFocus <span class=\"token operator\">&amp;&amp;</span> payoutAmountFocus<span class=\"token punctuation\">}</span> <span class=\"token comment\">// 조건부 autoFocus 설정</span>\r\n  onFocus<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">setPayoutAmountFocus</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 현재 필드에 포커스 설정</span>\r\n    <span class=\"token function\">setCollectionAmountFocus</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 다른 필드 포커스 해제</span>\r\n    <span class=\"token function\">setInvFocus</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 다른 필드 포커스 해제</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n  onChange<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>handleAmountChange<span class=\"token punctuation\">}</span>\r\n<span class=\"token operator\">/</span><span class=\"token operator\">></span></code></pre></div>\n<p>📌   handleAmountChange 함수를 onChange 이벤트 핸들러로 분리하여 사용했습니다.\r\n이를 통해 필드 간의 포커스를 자동으로 이동하는 대신, 상태 업데이트 후에도 사용자가 선택한 필드에 포커스가 유지되도록 했습니다.</p>\n<h3>3. 결론</h3>\n<p>React의 autoFocus 속성은 간단한 폼에서 문제없이 사용될 수 있지만, 상태 변화나 여러 입력 필드가 있는 상황에서는 제가 마주한 문제처럼 의도치 않은 동작이 발생 할 수 있습니다.\r\n이번 이슈에서는 autoFocus 대신 상태와 이벤트를 통해 포커스를 수동으로 제어하여 문제를 해결했습니다.</p>","frontmatter":{"title":"[React] autoFocus 문제 해결","summary":"autoFocus를 사용하여 특정 입력 필드에 자동으로 포커스를 맞추었지만, 다른 필드로 이동해 입력할 때 다시 autoFocus가 설정된 필드로 포커스가 이동하는 문제가 발생했습니다. 이 문제를 어떻게 해결했는지에 대한 설명입니다.","date":"2024.03.28.","categories":["All"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA60lEQVR42p2SO07DQBRFvRca9kFBwxbYDhVrYBFQBs/YE7BSICQLhJQPno/tyURKEBXQoIPsuKBInE9x9TR6elfvnbmRkZ7dqjv5f3Wzor0MRcDIOTat23qUoW4kmuESp95w6hWnXjDSoXtMo74ztVjgVE6dDVjlV/hRSqme0e3GBxmuT7NJQfWQ8T07gxDxYy+os0dsMsHIsJHnVsNCBFw6pRrGfE1P4fOcX3/CfHSLS8doGVosBzBsNjQdvxs+9CXL/Jpy+IRNdNvXx/xyM1yIBfHdgMm9xyWmNzp7xGbN6j2u0LLq3ttj8wd8vHNcWibooAAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/54305603eb214d087f016d798d77a64d/becf2/debugging.png","srcSet":"/static/54305603eb214d087f016d798d77a64d/1c872/debugging.png 175w,\n/static/54305603eb214d087f016d798d77a64d/3fd51/debugging.png 350w,\n/static/54305603eb214d087f016d798d77a64d/becf2/debugging.png 700w","sizes":"(min-width: 700px) 700px, 100vw"},"sources":[{"srcSet":"/static/54305603eb214d087f016d798d77a64d/5a1f0/debugging.webp 175w,\n/static/54305603eb214d087f016d798d77a64d/bb551/debugging.webp 350w,\n/static/54305603eb214d087f016d798d77a64d/efd8f/debugging.webp 700w","type":"image/webp","sizes":"(min-width: 700px) 700px, 100vw"}]},"width":700,"height":300}},"publicURL":"/static/54305603eb214d087f016d798d77a64d/debugging.png"}}}}]}},"pageContext":{"slug":"/debugging/autoFocus/"}},"staticQueryHashes":[],"slicesMap":{}}